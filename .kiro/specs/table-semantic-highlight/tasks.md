# 実装計画

- [x] 1. 型定義の更新
  - `shared/src/markdownFilterTypes.ts`に新しい除外タイプを追加
  - `ExcludeType`に`table-delimiter`と`table-separator`を追加
  - _要件: 1.2, 1.3_

- [x] 1.1 プロパティテスト: 除外タイプの追加
  - **プロパティ 5: 除外範囲情報の提供**
  - **検証: 要件 5.1, 5.2**

- [x] 2. MarkdownFilter.findTables()の変更
  - テーブル全体（`type: 'table'`）とテーブル構造要素（`type: 'table-delimiter'`, `type: 'table-separator'`）の両方を返すように変更
  - セパレーター行全体を`table-separator`として検出
  - 通常の行の区切り文字（|）を`table-delimiter`として検出
  - 既存の重複チェックロジック（コードブロックとの重複チェック）を維持
  - _要件: 1.2, 1.3_

- [x] 2.1 ユニットテスト: findTables()の基本動作
  - 基本的なテーブル構造の検出
  - テーブル全体と構造要素の両方が返されることを確認
  - _要件: 1.2, 1.3_

- [x] 2.2 プロパティテスト: テーブル構造要素の除外
  - **プロパティ 2: テーブル構造要素の除外**
  - **検証: 要件 1.2, 1.3**

- [x] 3. main.tsの変更
  - セマンティックハイライト用と文法チェック用で異なる除外範囲を使用
  - セマンティックハイライト用: `table`タイプを除外（`table-delimiter`と`table-separator`は含む）
  - 文法チェック用: すべての除外範囲を使用（既存の動作を維持）
  - それぞれの用途に応じてトークンをフィルタリング
  - _要件: 1.1, 3.1_

- [x] 3.1 ユニットテスト: 除外範囲のフィルタリング
  - セマンティックハイライト用の除外範囲が正しく作成されることを確認
  - 文法チェック用の除外範囲が既存の動作を維持することを確認
  - _要件: 1.1, 3.1_

- [x] 3.2 プロパティテスト: テーブル内日本語テキストのセマンティックトークン生成
  - **プロパティ 1: テーブル内日本語テキストのセマンティックトークン生成**
  - **検証: 要件 1.1, 1.4**

- [x] 3.3 プロパティテスト: 文法チェックにおけるテーブル全体の除外
  - **プロパティ 4: 文法チェックにおけるテーブル全体の除外**
  - **検証: 要件 3.1**

- [x] 4. チェックポイント - すべてのテストが通ることを確認
  - すべてのテストが通ることを確認し、質問があればユーザーに尋ねる

- [x] 5. テーブルセル内の除外要素の処理確認
  - テーブルセル内のインラインコード、URL、設定キーが正しく除外されることを確認
  - 既存の`findInlineCode()`, `findUrls()`, `findConfigKeys()`が正しく動作することを確認
  - _要件: 2.1, 2.2, 2.3, 2.4_

- [x] 5.1 ユニットテスト: テーブルセル内の除外要素
  - インラインコードを含むテーブルセルのテスト
  - URLを含むテーブルセルのテスト
  - 設定キーを含むテーブルセルのテスト
  - _要件: 2.1, 2.2, 2.3_

- [x] 5.2 プロパティテスト: テーブルセル内除外要素の処理
  - **プロパティ 3: テーブルセル内除外要素の処理**
  - **検証: 要件 2.1, 2.2, 2.3, 2.4**

- [x] 6. 統合テスト
  - 実際のMarkdownドキュメントでセマンティックハイライトが正しく動作することを確認
  - テーブル内の日本語テキストが色分けされることを確認
  - テーブル構造要素（区切り文字、セパレーター行）が色分けされないことを確認
  - 文法チェックがテーブル全体を除外することを確認
  - _要件: 1.1, 1.2, 1.3, 3.1_

- [x] 6.1 統合テスト: 複数のテーブルを含むドキュメント
  - 複数のテーブルを含むMarkdownドキュメントのテスト
  - _要件: 1.1, 1.2, 1.3_

- [x] 7. 最終チェックポイント - すべてのテストが通ることを確認
  - すべてのテストが通ることを確認し、質問があればユーザーに尋ねる
